{"version":3,"file":"index.modern.js","sources":["../src/index.js"],"sourcesContent":["import { Controller } from '@hotwired/stimulus';\nimport '@kanety/stimulus-static-actions';\nimport './index.scss';\n\nexport default class extends Controller {\n  static values = {\n    skipTags: String,\n    filter: { type: String, default: 'input[type=checkbox]' }\n  };\n  static actions = [\n    ['element', 'click->check'],\n    ['element', 'mousedown->disableUS'],\n    ['element', 'mouseup->enableUS'],\n    ['element', 'userselect->preventUS']\n  ];\n\n  static skipTags = 'a, input, select, textarea, button';\n\n  get items() {\n    return Array.from(this.element.children);\n  }\n\n  get checkboxes() {\n    return this.scope.findAllElements(this.filterValue).filter(cb => !cb.disabled);\n  }\n\n  get skipTags() {\n    let tags = this.constructor.skipTags;\n    if (this.hasSkipTagsValue) {\n      tags += ', ' + this.skipTagsValue;\n    }\n    return tags;\n  }\n\n  check(e) {\n    let item = e.target;\n    if (item == this.element) return;\n\n    let tags = this.skipTags;\n    while (item && item.parentNode != this.element) {\n      if (item.matches(tags)) return;\n      item = item.parentNode;\n    }\n\n    if (item) {\n      this.update(item, e.shiftKey, e.ctrlKey);\n    }\n  }\n\n  update(item, shift = false, ctrl = false) {\n    let curr = this.current;\n\n    if (shift && curr) {\n      this.uncheckAll();\n      this.checkBetween(curr, item);\n    } else if (ctrl) {\n      this.checkToggle(item);\n    } else {\n      this.uncheckAll();\n      this.checkItem(item);\n      this.current = item;\n    }\n  }\n\n  uncheckAll() {\n    this.checkboxes.forEach(cb => cb.checked = false);\n  }\n\n  checkItem(item) {\n    let cb = this.checkboxAt(item);\n    if (cb) cb.checked = true;\n  }\n\n  checkToggle(item) {\n    let cb = this.checkboxAt(item);\n    if (cb) cb.checked = !cb.checked;\n  }\n\n  checkBetween(item1, item2) {\n    let items = this.items;\n    let n1 = items.indexOf(item1);\n    let n2 = items.indexOf(item2);\n\n    if (n1 > n2) {\n      [n1, n2] = [n2, n1];\n    }\n\n    items.slice(n1, n2 + 1).forEach(item => {\n      let cb = this.checkboxAt(item);\n      if (cb) cb.checked = true;\n    });\n  }\n\n  checkboxAt(item) {\n    let cb = item.querySelector(this.filterValue);\n    return !cb.disabled ? cb : null;\n  }\n\n  disableUS(e) {\n    if (e.ctrlKey || e.shiftKey) {\n      this.toggleUS(false);\n    }\n  }\n\n  enableUS(e) {\n    if (e.ctrlKey || e.shiftKey) {\n      this.toggleUS(true);\n    }\n  }\n\n  toggleUS(enable) {\n    this.disableUserSelect = !enable;\n    if (enable) {\n      this.element.classList.remove('st-checklist--disable-us');\n    } else {\n      this.element.classList.add('st-checklist--disable-us');\n    }\n  }\n\n  preventUS(e) {\n    if (this.disableUserSelect) {\n      return false;\n    } else {\n      return true;\n    }\n  }\n}\n"],"names":["Controller","items","Array","from","this","element","children","checkboxes","scope","findAllElements","filterValue","filter","cb","disabled","skipTags","tags","constructor","hasSkipTagsValue","skipTagsValue","check","e","item","target","parentNode","matches","update","shiftKey","ctrlKey","shift","ctrl","curr","current","uncheckAll","checkBetween","checkToggle","checkItem","forEach","checked","checkboxAt","item1","item2","n1","indexOf","n2","slice","querySelector","disableUS","toggleUS","enableUS","enable","disableUserSelect","classList","remove","add","preventUS","values","String","type","default","actions"],"mappings":"wGAI6BA,EAcvBC,YACF,OAAOC,MAAMC,KAAKC,KAAKC,QAAQC,UAG7BC,iBACF,YAAYC,MAAMC,gBAAgBL,KAAKM,aAAaC,OAAOC,IAAOA,EAAGC,UAGnEC,eACF,IAAIC,EAAOX,KAAKY,YAAYF,SAI5B,OAHIV,KAAKa,mBACPF,GAAQ,KAAOX,KAAKc,eAEfH,EAGTI,MAAMC,GACJ,IAAIC,EAAOD,EAAEE,OACb,GAAID,GAAQjB,KAAKC,QAAS,OAE1B,IAAIU,EAAOX,KAAKU,SAChB,KAAOO,GAAQA,EAAKE,YAAcnB,KAAKC,SAAS,CAC9C,GAAIgB,EAAKG,QAAQT,GAAO,OACxBM,EAAOA,EAAKE,WAGVF,GACFjB,KAAKqB,OAAOJ,EAAMD,EAAEM,SAAUN,EAAEO,SAIpCF,OAAOJ,EAAMO,GAAQ,EAAOC,GAAO,GACjC,IAAIC,EAAO1B,KAAK2B,QAEZH,GAASE,GACX1B,KAAK4B,aACL5B,KAAK6B,aAAaH,EAAMT,IACfQ,EACTzB,KAAK8B,YAAYb,IAEjBjB,KAAK4B,aACL5B,KAAK+B,UAAUd,GACfjB,KAAK2B,QAAUV,GAInBW,aACE5B,KAAKG,WAAW6B,QAAQxB,GAAMA,EAAGyB,SAAU,GAG7CF,UAAUd,GACR,IAAIT,EAAKR,KAAKkC,WAAWjB,GACrBT,IAAIA,EAAGyB,SAAU,GAGvBH,YAAYb,GACV,IAAIT,EAAKR,KAAKkC,WAAWjB,GACrBT,IAAIA,EAAGyB,SAAWzB,EAAGyB,SAG3BJ,aAAaM,EAAOC,GAClB,IAAIvC,EAAQG,KAAKH,MACbwC,EAAKxC,EAAMyC,QAAQH,GACnBI,EAAK1C,EAAMyC,QAAQF,GAEnBC,EAAKE,KACNF,EAAIE,GAAM,CAACA,EAAIF,IAGlBxC,EAAM2C,MAAMH,EAAIE,EAAK,GAAGP,QAAQf,IAC9B,IAAIT,EAAKR,KAAKkC,WAAWjB,GACrBT,IAAIA,EAAGyB,SAAU,KAIzBC,WAAWjB,GACT,IAAIT,EAAKS,EAAKwB,cAAczC,KAAKM,aACjC,OAAQE,EAAGC,SAAgB,KAALD,EAGxBkC,UAAU1B,IACJA,EAAEO,SAAWP,EAAEM,WACjBtB,KAAK2C,UAAS,GAIlBC,SAAS5B,IACHA,EAAEO,SAAWP,EAAEM,WACjBtB,KAAK2C,UAAS,GAIlBA,SAASE,GACP7C,KAAK8C,mBAAqBD,EACtBA,EACF7C,KAAKC,QAAQ8C,UAAUC,OAAO,4BAE9BhD,KAAKC,QAAQ8C,UAAUE,IAAI,4BAI/BC,UAAUlC,GACR,OAAIhB,KAAK8C,qBAnHJK,OAAS,CACdzC,SAAU0C,OACV7C,OAAQ,CAAE8C,KAAMD,OAAQE,QAAS,2BAE5BC,QAAU,CACf,CAAC,UAAW,gBACZ,CAAC,UAAW,wBACZ,CAAC,UAAW,qBACZ,CAAC,UAAW,4BAGP7C,SAAW"}