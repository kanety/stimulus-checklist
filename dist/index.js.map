{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import { Controller } from '@hotwired/stimulus';\nimport '@kanety/stimulus-static-actions';\nimport './index.scss';\n\nexport default class extends Controller {\n  static values = {\n    filter: { type: String, default: 'input[type=checkbox]' }\n  };\n  static actions = [\n    ['element', 'click->check'],\n    ['element', 'mousedown->disableUS'],\n    ['element', 'mouseup->enableUS'],\n    ['element', 'userselect->preventUS']\n  ];\n\n  static skipTags = 'a, input, select, textarea, button';\n\n  get items() {\n    return Array.from(this.element.children);\n  }\n\n  get checkboxes() {\n    return this.scope.findAllElements(this.filterValue).filter(cb => !cb.disabled);\n  }\n\n  check(e) {\n    let item = e.target;\n    if (item == this.element) return;\n\n    while (item && item.parentNode != this.element) {\n      if (item.matches(this.constructor.skipTags)) return;\n      item = item.parentNode;\n    }\n\n    if (item) {\n      this.update(item, e.shiftKey, e.ctrlKey);\n    }\n  }\n\n  update(item, shift = false, ctrl = false) {\n    let curr = this.current;\n\n    if (shift && curr) {\n      this.uncheckAll();\n      this.checkBetween(curr, item);\n    } else if (ctrl) {\n      this.checkToggle(item);\n    } else {\n      this.uncheckAll();\n      this.checkItem(item);\n      this.current = item;\n    }\n  }\n\n  uncheckAll() {\n    this.checkboxes.forEach(cb => cb.checked = false);\n  }\n\n  checkItem(item) {\n    let cb = this.checkboxAt(item);\n    if (cb) cb.checked = true;\n  }\n\n  checkToggle(item) {\n    let cb = this.checkboxAt(item);\n    if (cb) cb.checked = !cb.checked;\n  }\n\n  checkBetween(item1, item2) {\n    let items = this.items;\n    let n1 = items.indexOf(item1);\n    let n2 = items.indexOf(item2);\n\n    if (n1 > n2) {\n      [n1, n2] = [n2, n1];\n    }\n\n    items.slice(n1, n2 + 1).forEach(item => {\n      let cb = this.checkboxAt(item);\n      if (cb) cb.checked = true;\n    });\n  }\n\n  checkboxAt(item) {\n    let cb = item.querySelector(this.filterValue);\n    return !cb.disabled ? cb : null;\n  }\n\n  disableUS(e) {\n    if (e.ctrlKey || e.shiftKey) {\n      this.toggleUS(false);\n    }\n  }\n\n  enableUS(e) {\n    if (e.ctrlKey || e.shiftKey) {\n      this.toggleUS(true);\n    }\n  }\n\n  toggleUS(enable) {\n    this.disableUserSelect = !enable;\n    if (enable) {\n      this.element.classList.remove('st-checklist--disable-us');\n    } else {\n      this.element.classList.add('st-checklist--disable-us');\n    }\n  }\n\n  preventUS(e) {\n    if (this.disableUserSelect) {\n      return false;\n    } else {\n      return true;\n    }\n  }\n}\n"],"names":["Controller","items","Array","from","this","element","children","checkboxes","scope","findAllElements","filterValue","filter","cb","disabled","check","e","item","target","parentNode","matches","constructor","skipTags","update","shiftKey","ctrlKey","shift","ctrl","curr","current","uncheckAll","checkBetween","checkToggle","checkItem","forEach","checked","checkboxAt","item1","item2","n1","indexOf","n2","slice","querySelector","disableUS","toggleUS","enableUS","enable","disableUserSelect","classList","remove","add","preventUS","values","type","String","default","actions"],"mappings":"+FAI6BA,aAavBC,YACF,OAAOC,MAAMC,KAAKC,KAAKC,QAAQC,UAG7BC,iBACF,YAAYC,MAAMC,gBAAgBL,KAAKM,aAAaC,OAAOC,IAAOA,EAAGC,UAGvEC,MAAMC,GACJ,IAAIC,EAAOD,EAAEE,OACb,GAAID,GAAQZ,KAAKC,QAAjB,CAEA,KAAOW,GAAQA,EAAKE,YAAcd,KAAKC,SAAS,CAC9C,GAAIW,EAAKG,QAAQf,KAAKgB,YAAYC,UAAW,OAC7CL,EAAOA,EAAKE,WAGVF,GACFZ,KAAKkB,OAAON,EAAMD,EAAEQ,SAAUR,EAAES,UAIpCF,OAAON,EAAMS,EAAeC,YAAfD,IAAAA,GAAQ,YAAOC,IAAAA,GAAO,GACjC,IAAIC,EAAOvB,KAAKwB,QAEZH,GAASE,GACXvB,KAAKyB,aACLzB,KAAK0B,aAAaH,EAAMX,IACfU,EACTtB,KAAK2B,YAAYf,IAEjBZ,KAAKyB,aACLzB,KAAK4B,UAAUhB,GACfZ,KAAKwB,QAAUZ,GAInBa,aACEzB,KAAKG,WAAW0B,QAAQrB,GAAMA,EAAGsB,SAAU,GAG7CF,UAAUhB,GACR,IAAIJ,EAAKR,KAAK+B,WAAWnB,GACrBJ,IAAIA,EAAGsB,SAAU,GAGvBH,YAAYf,GACV,IAAIJ,EAAKR,KAAK+B,WAAWnB,GACrBJ,IAAIA,EAAGsB,SAAWtB,EAAGsB,SAG3BJ,aAAaM,EAAOC,GAClB,IAAIpC,EAAQG,KAAKH,MACbqC,EAAKrC,EAAMsC,QAAQH,GACnBI,EAAKvC,EAAMsC,QAAQF,GAEnBC,EAAKE,KACNF,EAAIE,GAAM,CAACA,EAAIF,IAGlBrC,EAAMwC,MAAMH,EAAIE,EAAK,GAAGP,QAAQjB,IAC9B,IAAIJ,EAAKR,KAAK+B,WAAWnB,GACrBJ,IAAIA,EAAGsB,SAAU,KAIzBC,WAAWnB,GACT,IAAIJ,EAAKI,EAAK0B,cAActC,KAAKM,aACjC,OAAQE,EAAGC,SAAgB,KAALD,EAGxB+B,UAAU5B,IACJA,EAAES,SAAWT,EAAEQ,WACjBnB,KAAKwC,UAAS,GAIlBC,SAAS9B,IACHA,EAAES,SAAWT,EAAEQ,WACjBnB,KAAKwC,UAAS,GAIlBA,SAASE,GACP1C,KAAK2C,mBAAqBD,EACtBA,EACF1C,KAAKC,QAAQ2C,UAAUC,OAAO,4BAE9B7C,KAAKC,QAAQ2C,UAAUE,IAAI,4BAI/BC,UAAUpC,GACR,OAAIX,KAAK2C,qBAzGJK,OAAS,CACdzC,OAAQ,CAAE0C,KAAMC,OAAQC,QAAS,2BAE5BC,QAAU,CACf,CAAC,UAAW,gBACZ,CAAC,UAAW,wBACZ,CAAC,UAAW,qBACZ,CAAC,UAAW,4BAGPnC,SAAW"}